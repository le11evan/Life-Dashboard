generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// Milestone 2: Tasks
model Task {
  id        String    @id @default(cuid())
  title     String
  notes     String?
  status    String    @default("pending") // pending, completed
  dueDate   DateTime?
  priority  Int       @default(0) // 0=none, 1=low, 2=medium, 3=high
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt

  @@index([status])
  @@index([dueDate])
}

// Milestone 2: Groceries
model GroceryItem {
  id        String   @id @default(cuid())
  name      String
  category  String?
  isChecked Boolean  @default(false)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([isChecked])
}

// Milestone 3: Journal
model JournalEntry {
  id        String   @id @default(cuid())
  content   String
  tags      String[] @default([])
  mood      String?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([createdAt])
}

// Milestone 3: Daily Quote
model DailyQuote {
  id        String   @id @default(cuid())
  date      DateTime @unique @db.Date
  quote     String
  author    String?
  source    String?
  createdAt DateTime @default(now())
}

// Milestone 4: Fitness - Workouts
model Workout {
  id        String            @id @default(cuid())
  date      DateTime          @default(now())
  name      String?           // e.g., "Push Day", "Leg Day"
  notes     String?
  createdAt DateTime          @default(now())
  updatedAt DateTime          @updatedAt
  exercises WorkoutExercise[]

  @@index([date])
}

// Milestone 4: Fitness - Exercises within a workout
model WorkoutExercise {
  id           String   @id @default(cuid())
  workoutId    String
  exerciseName String
  // JSON array: [{weight: number, reps: number, notes?: string}]
  sets         Json     @default("[]")
  notes        String?
  order        Int      @default(0)
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
  workout      Workout  @relation(fields: [workoutId], references: [id], onDelete: Cascade)

  @@index([workoutId])
  @@index([exerciseName])
}

// Milestone 5: Finance - Portfolio Holdings
model Holding {
  id           String   @id @default(cuid())
  symbol       String   @unique
  shares       Float
  avgCost      Float
  currentPrice Float?   // Optional: manually updated or from API
  notes        String?
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt

  @@index([symbol])
}

// Milestone 5: Finance - Watchlist
model WatchlistItem {
  id        String   @id @default(cuid())
  symbol    String   @unique
  notes     String?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([symbol])
}

// Milestone 5: Finance - Stock Research Cache
model StockResearch {
  id          String   @id @default(cuid())
  symbol      String   @unique
  // JSON: {financials, catalysts, sentiment, predictions, summary}
  data        Json
  generatedAt DateTime @default(now())

  @@index([symbol])
}
